<?php
$countryCallingCodes = array
(
    '+1'=>'USA',
    93 => "Afghanistan",
    355 => "Albania",
    213 => "Algeria",
    376 => "Andorra",
    244 => "Angola",
    54 => "Argentina",
    374 => "Armenia",
    297 => "Aruba",
    247 => "Ascension",
    61 => "Australia",
    43 => "Austria",
    994 => "Azerbaijan",
    973 => "Bahrain",
    880 => "Bangladesh",
    375 => "Belarus",
    32 => "Belgium",
    501 => "Belize",
    229 => "Benin",
    '++1' => "Bermuda",
    975 => "Bhutan",
    591 => "Bolivia",
    387 => "Bosnia and Herzegovina",
    267 => "Botswana",
    55 => "Brazil",
    '+++1' => "British Virgin Islands",
    673 => "Brunei",
    359 => "Bulgaria",
    226 => "Burkina Faso",
    257 => "Burundi",
    855 => "Cambodia",
    237 => "Cameroon",
    '++++1' => "Canada",
    238 => "Cape Verde",
    '+++++1' => "Cayman Islands",
    236 => "Central African Republic",
    235 => "Chad",
    56 => "Chile",
    86 => "China",
    57 => "Colombia",
    269 => "Comoros",
    242 => "Congo",
    682 => "Cook Islands",
    506 => "Costa Rica",
    385 => "Croatia",
    53 => "Cuba",
    357 => "Cyprus",
    420 => "Czech Republic",
    243 => "Democratic Republic of Congo",
    45 => "Denmark",
    246 => "Diego Garcia",
    253 => "Djibouti",
    '++++++1' => "Dominica",
    '+++++++1' => "Dominican Republic",
    670 => "East Timor",
    593 => "Ecuador",
    20 => "Egypt",
    503 => "El Salvador",
    240 => "Equatorial Guinea",
    291 => "Eritrea",
    372 => "Estonia",
    251 => "Ethiopia",
    500 => "Falkland (Malvinas) Islands",
    298 => "Faroe Islands",
    679 => "Fiji",
    358 => "Finland",
    33 => "France",
    594 => "French Guiana",
    689 => "French Polynesia",
    241 => "Gabon",
    220 => "Gambia",
    995 => "Georgia",
    49 => "Germany",
    233 => "Ghana",
    350 => "Gibraltar",
    30 => "Greece",
    299 => "Greenland",
    '++++++++1' => "Grenada",
    590 => "Guadeloupe",
    '+++++++++1' => "Guam",
    502 => "Guatemala",
    224 => "Guinea",
    245 => "Guinea-Bissau",
    592 => "Guyana",
    509 => "Haiti",
    504 => "Honduras",
    852 => "Hong Kong",
    36 => "Hungary",
    354 => "Iceland",
    91 => "India",
    62 => "Indonesia",
    870  => "Inmarsat Satellite",
    98 => "Iran",
    964 => "Iraq",
    353 => "Ireland",
    972 => "Israel",
    39 => "Italy",
    225 => "Ivory Coast",
    '+++++++++++1' => "Jamaica",
    81 => "Japan",
    962 => "Jordan",
    7 => "Kazakhstan",
    254 => "Kenya",
    686 => "Kiribati",
    965 => "Kuwait",
    996 => "Kyrgyzstan",
    856 => "Laos",
    371 => "Latvia",
    961 => "Lebanon",
    266 => "Lesotho",
    231 => "Liberia",
    218 => "Libya",
    423 => "Liechtenstein",
    370 => "Lithuania",
    352 => "Luxembourg",
    853 => "Macau",
    389 => "Macedonia",
    261 => "Madagascar",
    265 => "Malawi",
    60 => "Malaysia",
    960 => "Maldives",
    223 => "Mali",
    356 => "Malta",
    692 => "Marshall Islands",
    596 => "Martinique",
    222 => "Mauritania",
    230 => "Mauritius",
    262 => "Mayotte",
    52 => "Mexico",
    691 => "Micronesia",
    373 => "Moldova",
    377 => "Monaco",
    976 => "Mongolia",
    382 => "Montenegro",
    "++++++++++++1" => "Montserrat",
    212 => "Morocco",
    258 => "Mozambique",
    95 => "Myanmar",
    264 => "Namibia",
    674 => "Nauru",
    977 => "Nepal",
    31 => "Netherlands",
    599 => "Netherlands Antilles",
    687 => "New Caledonia",
    64 => "New Zealand",
    505 => "Nicaragua",
    227 => "Niger",
    234 => "Nigeria",
    683 => "Niue Island",
    850 => "North Korea",
    "+++++++++++++1" => "Northern Marianas",
    47 => "Norway",
    968 => "Oman",
    92 => "Pakistan",
    680 => "Palau",
    507 => "Panama",
    675 => "Papua New Guinea",
    595 => "Paraguay",
    51 => "Peru",
    63 => "Philippines",
    48 => "Poland",
    351 => "Portugal",
    '-1' => "Puerto Rico",
    974 => "Qatar",
    262 => "Reunion",
    40 => "Romania",
    7 => "Russian Federation",
    250 => "Rwanda",
    290 => "Saint Helena",
    '--1' => "Saint Kitts and Nevis",
    '---1' => "Saint Lucia",
    508 => "Saint Pierre and Miquelon",
    '----1' => "Saint Vincent and the Grenadines",
    685 => "Samoa",
    378 => "San Marino",
    239 => "Sao Tome and Principe",
    966 => "Saudi Arabia",
    221 => "Senegal",
    381 => "Serbia",
    248 => "Seychelles",
    232 => "Sierra Leone",
    65 => "Singapore",
    421 => "Slovakia",
    386 => "Slovenia",
    677 => "Solomon Islands",
    252 => "Somalia",
    27 => "South Africa",
    82 => "South Korea",
    34 => "Spain",
    94 => "Sri Lanka",
    249 => "Sudan",
    597 => "Suriname",
    268 => "Swaziland",
    46 => "Sweden",
    41 => "Switzerland",
    963 => "Syria",
    886 => "Taiwan",
    992 => "Tajikistan",
    255 => "Tanzania",
    66 => "Thailand",
    228 => "Togo",
    690 => "Tokelau",
    '----1' => "Trinidad and Tobago",
    216 => "Tunisia",
    90 => "Turkey",
    993 => "Turkmenistan",
    '------1' => "Turks and Caicos Islands",
    688 => "Tuvalu",
    256 => "Uganda",
    380 => "Ukraine",
    971 => "United Arab Emirates",
    44 => "United Kingdom",
    '-------1' => "United States of America",
    '--------1' => "U.S. Virgin Islands",
    598 => "Uruguay",
    998 => "Uzbekistan",
    678 => "Vanuatu",
    379 => "Vatican City",
    58 => "Venezuela",
    84 => "Vietnam",
    681 => "Wallis and Futuna",
    967 => "Yemen",
    260 => "Zambia",
    263 => "Zimbabwe"
);
?>
<div style="" class="register-form-main">
    <div style="padding-bottom: 0px;">
        <div>

            <div style="width: 100%; background: white; white-space: nowrap; color: black;">
                <div class="row">
                    <div class="alert alert-info">Please sign in or create a new account to continue</div>
                </div>
                <button onclick="showLogin()" id="tab-old" tabindex="0" type="button" class="btn-reg-tab">
                    <div>
                        <span style="height: 100%; width: 100%; position: absolute; top: 0px; left: 0px; overflow: hidden;"></span>
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 48px;">
                            I have an account</div>
                    </div>
                </button>
                <button onclick="showRegister()" id="tab-new" tabindex="0" type="button" class="btn-reg-tab">
                    <div>
                        <span style="height: 100%; width: 100%; position: absolute; top: 0px; left: 0px; overflow: hidden;"></span>
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 48px;">
                            I am new here</div>
                    </div>
                </button>
            </div>
            <div>
                <div class="green_line login-line"></div>
                <div style="display: none;" class="green_line register-line"></div>
            </div>
            <div>
                <div id="login_form_tab" style="width: 100%; position: relative; text-align: initial;">
                    <div style="padding: 20px 20px 5px;">
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Email</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="email" value=""  placeholder="Enter your e-mail here" name="old_email" class="form-control">
                                <div id="email_error_login" style="display:none;color:red;" class="error">Invalid username or password</div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Password</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="password" value=""  placeholder="Enter your password" name="old_password" class="form-control">
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">&nbsp;</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <button onclick="loginUser();" type="button" class="btn btn-info btn-sm">Login</button>
                                <i style="display: none;" class="fa fa-spinner fa-spin fa-2x"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="register_form_tab" style="width: 100%; position: relative; text-align: initial;display: none;">
                    <div style="padding: 20px 20px 5px;">
                        <?php echo e(csrf_field()); ?>

                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Name</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="text" value=""  placeholder="Enter your name here" name="name" class="form-control">
                                <div id="name_error" class="error" style=""></div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Email</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="email" value=""  placeholder="Enter your e-mail here" name="email" class="form-control">
                                <div id="email_error" class="error" style=""></div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Phone</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <div class="col-md-5">

                                    <select style="margin-left: -18;" class="form-control" name="country">

                                        <?php foreach($countryCallingCodes as $key=>$val): ?>
                                            <?php
                                            $key = str_replace('-','',$key);
                                            $key = str_replace('+','',$key);
                                            similar_text($country,$val,$percent);
                                            $more = 90;
                                            if($percent > $more)
                                                $more=$percent

                                            ?>
                                            <option <?php echo e($more>90 ? 'selected':''); ?> value="<?php echo e($val.'(+'.$key.')'); ?>"><?php echo e($val.'(+'.$key.')'); ?></option>
                                        <?php endforeach; ?>
                                    </select>
                                </div>
                                <div class="col-md-7">
                                    <input name="phone" value="" class="form-control" type="text" class="input-large">
                                    <div id="phone_error" class="error" style=""></div>
                                </div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Password</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="password" value=""  placeholder="Enter your password" name="password" class="form-control">

                                <div id="password_error" class="error" style=""></div>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">Confirm Password</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <input type="password" value=""  placeholder="" name="password_confirmation" class="form-control">
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-xs-12 col-sm-3 col-md-4 align-left control-label">&nbsp;</label>
                            <div class="col-xs-12 col-sm-9 col-md-8">
                                <button onclick="registerUser();" type="button" class="btn btn-info btn-sm">Register</button>
                                <i style="display: none;" class="fa fa-spinner fa-spin fa-2x"></i>

                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<style type="text/css">
    .register-form-main{
        color: rgba(0, 0, 0, 0.870588);
        background-color: rgb(255, 255, 255);
        transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;
        box-sizing: border-box;
        font-family: Roboto, sans-serif;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        box-shadow: rgba(0, 0, 0, 0.117647) 0px 1px 6px, rgba(0, 0, 0, 0.117647) 0px 1px 4px;
        border-radius: 2px; z-index: 1; overflow: visible;
    }
    .btn-reg-tab{
        border: 10px;
        box-sizing: border-box;
        display: inline-block;
        font-family: Roboto, sans-serif;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        cursor: pointer;
        text-decoration: none;
        margin: 0px;
        padding: 0px;
        outline: none;
        font-size: 14px;
        font-weight: 500;
        transform: translate(0px, 0px);
        color: rgb(45, 149, 191);
        width: 50%;
        text-transform: uppercase;
        background: none;
    }
    .green_line{
        width: 50%;
        bottom: 0px;
        display: block;
        background-color: rgb(45, 149, 191);
        height: 2px; margin-top: -2px;
        position: relative;
        transition: left 1s cubic-bezier(0.23, 1, 0.32, 1) 0ms;
    }

    .login-line{
        left: 0%;
    }
    .register-line{
        left: 50%;
    }
    .error{
        color:red;
    }
</style>
<script type="text/javascript">
    function showLogin(){
        jQuery("#register_form_tab").slideUp();
        jQuery("#login_form_tab").slideDown();
        jQuery(".login-line").show();
        jQuery(".register-line").hide();
    }

    function showRegister(){
        jQuery("#register_form_tab").slideDown();
        jQuery("#login_form_tab").slideUp();
        jQuery(".login-line").hide();
        jQuery(".register-line").show();
    }

    function showPassword(){
        var attr = jQuery("input[name='password']").attr('type');
        if(attr == 'password'){
            jQuery("input[name='password']").attr('type','text');
        }else{
            jQuery("input[name='password']").attr('type','password');
        }
    }

    function loginUser(){
        $(".fa-spinner").show();
        $("#loading_submit").hide();
        $("#email_error_login").slideUp();
        var password = $("input[name='old_password']").val();
        var email = $("input[name='old_email']").val();
        var token = '<?php echo e(csrf_token()); ?>';
        var data = {email:email,password:password,_token:token};
        console.log(data);
        var url = '<?php echo e(URL::to('users/login')); ?>';
        $.post(url,data ,function(response){
            $(".fa-spinner").hide();
            if(typeof  response =='object'){
                var result = response;
            }else{
                var result = JSON.parse(response);
            }
            if(result.status==false){
                $("#email_error_login").slideDown();
                $("#email_error_login").html(result.error);
            }else{
                window.location.reload(true);
                $("#registration_tab").slideUp();
                $("#tabs_customer_type").slideDown();
                $(".orderform-submit").removeAttr('disabled');
                $("input[name='user_id']").val(result.id);
                $(".tabs_customer_type_content").html('<p>Welcome back <strong>'+result.name+'</strong>!</p>');
            }
        });
        return false;
    }
    function registerUser(){
        $(".customer_login").prop('disabled','disabled');
        $(".fa-spinner").show();
        $("#loading_submit").hide();
        var data = $('#register_form_tab :input').serialize();
        var url = '<?php echo e(URL::to('users/register')); ?>';
//        alert(url);return false;
        $.post(url,data,function(response){
            $(".customer_login").removeAttr('disabled');
            $(".fa-spinner").hide();
            if(typeof response =='object'){
                var result = response;
            }else{
                var result = JSON.parse(response);
            }
            console.log(response);

            if(result.id==undefined){
                for(var key in result){
                    $("#"+key+"_error").html(''+result[key][0]+'</li>');
                }
                setTimeout(function() {
                    $(".error").html('');
                }, 2500);
            }else{
                window.location.reload(true);
                $("#registration_tab").slideUp();
                $("#tabs_customer_type").slideDown();
                $(".orderform-submit").removeAttr('disabled');
                $("input[name='user_id']").val(result.id);
                $(".tabs_customer_type_content").html('<p>Welcome <strong>'+result.name+'</strong>!</p>');
            }
        }).fail(function(xhr,status,error){
            var response = xhr.responseJSON;
            if(typeof response =='object'){
                var result = response;
            }else{
                var result = JSON.parse(response);
            }
            console.log(response);

            if(result.id==undefined){
                for(var key in result){
                    $("#"+key+"_error").html(''+result[key][0]+'</li>');
                }
                setTimeout(function() {
                    $(".error").html('');
                }, 2500);
            }else{
                $("#registration_tab").slideUp();
                $("#tabs_customer_type").slideDown();
                $(".orderform-submit").removeAttr('disabled');
                $("input[name='user_id']").val(result.id);
                $(".tabs_customer_type_content").html('<p>Welcome <strong>'+result.name+'</strong>!</p>');
            }
        });

        return false;
    }
</script>